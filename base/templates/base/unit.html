{% extends 'main.html' %}
{% load static %}
{% block content %}
<br>
<br>
<br>
<br>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <!-- <title>PAL</title> -->
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css"/>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap');
    </style>
</head>

<div class="bg-gray-100 flex flex-col lg:flex-row ">

    <div id="menu-toggle" class="lg:hidden cursor-pointer px-4 py-2 bg-gray-800 text-white">
        &#9776; 
    </div>

   
    <div id="sidebar" class="h-screen w-80 bg-gray-200 lg:block lg:overflow-y-auto pb-2">
        <div class="p-0">
            {% for unit in units %}
                <h1 class="text-xl font-bold py-3 px-4 text-gray-800">Unit {{ unit.id }}: {{ unit.title }}</h1>
                
                <ul>
                    {% for lesson in unit.lessons.all %}
                        <li class="mb-1">
                            <!-- Add a data-lesson-id attribute to store the lesson id -->
                            <a href="#" class="block py-.75 px-4 text-gray-800 hover:bg-green-400 lesson-link" data-lesson-id="{{ lesson.id }}">{{ lesson.title }}</a>
                        </li>
                    {% endfor %}
                </ul>
            {% endfor %}
        </div>
    </div>
    
    <div id="lesson-content" class="flex-1 pl-6 pt-2 pb-6 pr-6 h-screen overflow-y-auto">
        
        <div class="bg-black-200">
            <!-- Content will be populated here -->
        </div>
    </div>
    <script>
        $(document).ready(function() {
            // AJAX request for lesson content
            $('.lesson-link').click(function(e) {
                e.preventDefault();
                var lessonId = $(this).data('lesson-id');
                $.ajax({
                    url: '/get_lesson_content/',
                    data: {'lesson_id': lessonId},
                    success: function(response) {
                        console.log(response);
                        $('#lesson-content .bg-black-200').html(response.lesson_content);
                    },
                    error: function(error) {
                        console.error('Error fetching lesson content:', error);
                    }
                });
            });
    
            // Toggle sidebar and content display
            const menuToggle = $('#menu-toggle');
            const sidebar = $('#sidebar');
            const content = $('#content');
    
            function updateSidebarDisplay() {
                if (window.innerWidth < 1024 || window.innerWidth > 1024) {
                    sidebar.addClass('hidden').css('overflowY', 'auto');
                } else {
                    sidebar.removeClass('hidden').css('overflowY', 'visible');
                }
            }
    
            updateSidebarDisplay();
    
            $(window).on('resize', updateSidebarDisplay);
    
            menuToggle.on('click', function() {
                sidebar.toggleClass('hidden');
                content.css('display', sidebar.hasClass('hidden') ? 'block' : 'none');
            });
        });
    </script>
</di>

{% endblock content %}
